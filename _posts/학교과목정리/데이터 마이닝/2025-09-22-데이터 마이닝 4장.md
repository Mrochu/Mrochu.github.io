---
layout: post
title:  "데이터 마이닝 4장"
date:   2025-09-22- 12:59:14 +0900
categories: [학교과목정리,데이터 마이닝]
---

# 4장 의사 결정 나무
``` R
rpart(formula, data, weights, subset, na.action=na.rpart, method, parms, control, cost, ...)
# formula: R에서 사용하는 모형 관련 공식. 옵션 data의 데이터 프레임에 존재하는 변수이름만 사용 가능
# data: 훈련 데이터에 해당하는 데이터 프레임 이름
# weights : 훈련 데이터의 관찰값에 대한 가중치 벡터. 디폴트는 균등가중치
# subset: 조건에 맞는 훈련 데이터의 일부분만 사용하고자 할 때. 디폴트는 전체 사용
# na.action=na.rpart: 목표변수가 결측치이면 전체 관찰값을 삭제. 입력변수가 결측치인 경우에는 삭제하지 않음
# method : 의사결정나무의 종류를 지정. “anova”，“poisson”，“class”, “exp” 중에서 선택해야 하며，“anova” 선택 시 회귀나무， “poisson” 선택 시 포아송 회귀나무，“class” 선택 시 분류나무，“exp” 선택 시 생존나무가 생성됨. 디폴트는 “class”

#ex)
install.packages("rpart")
library(rpart)
c <- rpart(Species ~., data=iris)

plot(c) # 트리 그리기
text(c) # 트리에 글쓰기

# 트리 가지치기 
c$cptable # 트리의 크기에 따른 비용-복잡도 모수를 이야기 한다.
plotcp(c) # 유의 수준 그래프로서 유의수준 아래로 내려온 size 일때 가장 적합하다. 

opt <- which.min(c$cptable[,"xerror"]) # 최소의 유의수준 사이즈를 찾는다
cp <- c$cptable[opt, "CP"] #찾은 사이즈를 통해서 가지치기를 위한 복잡도 모수를 찾는다.

prune.c <- prune(c, cp = cp) # 가지치기를 진행한다. 
prune.c_predict <- predict(prune.c, newdata=iris, type="class") #예측수행
table(iris$Species, prune.c_predict) # 혼동행렬

library(caret)
confusionMatrix(iris$Species, prune.c_predict) # 정확도 민감도 특이도등을 확인

ctree(formula, data) # ctree는 가지치기가 필요없다.
``` 

