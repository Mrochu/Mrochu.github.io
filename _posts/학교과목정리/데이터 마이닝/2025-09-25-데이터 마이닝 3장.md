---
layout: post
title:  "데이터 마이닝 3장"
date:   2025-09-25- 12:59:14 +0900
categories: [학교과목정리,데이터 마이닝]
---

# 3장 로지스틱 회귀

## 1.선형 회귀 모형
- 기본적으로 관찰된 연속형 변수들에 대해 두 변수 사이의 모형을 구한 뒤 적합도를 측
정해 내는 분석 방법
- 시간에 따라 변화하는 데이터나 어떤 영향, 가설적 실험, 인과 관계의 모델링 등의 통
계적 예측에 이용
- 단순예측분석 : 하나의 종속(반응)변수와 하나의 독립(설명)변수 사이의 관계를 분석
- 다중예측분석: 하나의 종속(반응)변수와 여러 독립(설명)변수 사이의 관계를 분석
- 선형회귀와 비선형회귀가 존재함

회귀모형관련 R코드
``` R
lm(formula, data, na.action) #함수 lm은 선형모형을 적합하기 위해 사용
#formula : 적합할 모형의 공식으로 ‘목표변수〜 입력변수의 선형결합’ 형식으로 구성. 
#data : 사용할 데이터 프레임의 이름을 지정
#na.action: 결측치 처리 옵션. na.fail은 결측치가 있으면 오류 메시지 발생, 

step(object, direction=c(“both”, “backward”, "forward"))
# 함수 step은 AIC를 이용한 모형선택을 위해 사용
# object : 함수 lm, glm 등에서 생성한 object를 입력
# direction : 변수선택 방법(“both”= 단계적 변수선택, “backward” =후진소거법, “forward”=전진선택법)을 지정함

predict(object, newdata, type)
# 함수 predict는 다양한 모형적합 결과로부터 예측값을 계산할 때 사용
# object : 함수 lm, glm 등에서 생성한 object를 입력
# newdata: 예측할 변수들로 구성된 데이터 프레임을 입력
# type : 예측형태를 입력하는 것으로, 목표값을 예측할 때 type = “response” 를 사용
```

### 선형회귀모형 - 실습
신뢰관계, 기업문화, 스트레스, 인재우대, 기업혁신이 조직몰입에 영향을 미칠 것이다
신뢰관계, 기업문화, 조직몰입, 만족도, 스트레스, 인재우대, 기업혁신:연속형 자료
조직몰입 : 종속(반응) 변수
신뢰관계, 기업문화, 스트레스, 인재우대, 기업혁신 : 독립(설명) 변수
데이터 : r_reg.csv(40개의 변수, 3430개의 케이스)

```R
reg <- read.csv("r_reg.csv",fileEncoding = "EUC-KR")
str(reg)

# library(dplyr) 은 파이프 라이닝 라이브러리 %>% 는 파이프 라이닝을 의미
library(dplyr)
mr <- reg %>% dplyr::select(신뢰관계,기업문화,스트레스,인재우대,기업혁신,조직몰입)
summary(mr)

mr.fit.all <- lm(조직몰입 ~ 신뢰관계+기업문화+스트레스+인재우대+기업혁신,data=mr)
summary(mr.fit.all)

par(mfrow=c(2,2))
plot(mr.fit.all,main = "multi linear regression")

par(mfrow=c(1,1))
hist(rstandard(mr.fit.all))         #정규성(히스토그램)
shapiro.test(rstandard(mr.fit.all)) #독립성 검정

library(nortest)
lillie.test(rstandard(mr.fit.all))

# 자기상관 더빈왓슨 검정
library(lmtest)
dwtest(mr.fit.all)

#다자우 회귀 분석 : 다중공선성 검정
# 독립변수들의 상관 분석
cor(mr) # 종속변수를 포함하는 다중곤선선 검정

mr_ind <- mr[,c(1:5)] # 조직몰입은 종속변수이기에 제거
round(cor(mr_ind),3)

#분산 팽창지수
library(car)
vif(mr.fit.all)
#공차한계
tol <- 1/vif(mr.fit.all)


#본격적인 회귀모형 분석의 시작
mr.fit.step <- step(mr.fit.all,direction = "both")
# aic 가 작을수록 좋은 모형
summary(mr.fit.step)

#예측및 평가
pred.mr = predict(mr.fit.step,newdata = reg,type = "response")
#mse
mean((mr$조직몰입-pred.mr)^2)
#mae
mean(abs(mr$조직몰입-pred.mr))
```

## 2.로지스틱회귀

로지스틱 회귀(logistic regression)모형은 반응변수가 범주형인 경우에 적용되는 회귀분석모형
이 방법은 새로운 설명변수(또는 예측변수)의 값이 주어질 때 반응변수의 각 범주(또는 집단)에 속할 확률이 얼마인지를 추정해 주며(예측모형), 추정확률의 기준치에 따라 분류의 목적으로 사용될수도 있다(분류모형).

회귀모형 관련 R 함수
``` R
glm(formula, family, data, na.action) # 함수 glm은 일반화선형모형을 적합하기 위해 사용
#formula : 적합할 모형의 공식으로 ‘목표변수〜 입력변수의 선형결합’ 형식으로 구성. 
#family : 분포와 연결함수를 설정할 때 사용.
#data : 사용할 데이터 프레임의 이름을 지정
#na.action: 결측치 처리 옵션. na.fail은 결측치가 있으면 오류 메시지 발생, 
```

### 로지스틱회귀모형 실습

주어진 두 종류의 iris를 분류할 수 있을 것이다.
데이터 : iris(5개의 변수, 150개의 케이스)
독립(설명) 변수 : 4개의 변수(Sepal.Length, Sepal.Width, Petal.Length, Petal.Width)
종속(반응) 변수 : Species(setosa, versicolor, virginica)
반응변수의 범주가 2개인 로지스틱 회귀를 적용하기 위해 iris 자료의 일부분(100개)만 이용(Species – setosa, versicolor)

``` R
#로지스틱 회귀 분석
data(iris)
a <- subset(iris,Species == "setosa" |Species == "versicolor")
a$Species <- factor(a$Species)
str(a)

b <- glm(Species~Sepal.Length,data=a,family=binomial)
summary(b)

pred.iris <- predict(b,newdata = a,type = "response")
pred.iris
yhat.iris <- ifelse(pred.iris > 0.5,"versicolor","setosa")
yhat.iris
table_iris <- table(a$Species,yhat.iris)
table_iris

#install.packages("e1071")
#confusionMatrix 는 행은 예측값 열은 실제 값이 들어가야함
library(caret)
confusionMatrix(t(table_iris)) #입력값 전치되어 있지 않으면 전치해야함
```