---
layout: post
title:  "데이터 마이닝 3장"
date:   2025-09-25- 12:59:14 +0900
categories: [학교과목정리,데이터 마이닝]
---

# 3장 로지스틱 회귀

## 1.선형 회귀 모형
- 기본적으로 관찰된 연속형 변수들에 대해 두 변수 사이의 모형을 구한 뒤 적합도를 측
정해 내는 분석 방법
- 시간에 따라 변화하는 데이터나 어떤 영향, 가설적 실험, 인과 관계의 모델링 등의 통
계적 예측에 이용
- 단순예측분석 : 하나의 종속(반응)변수와 하나의 독립(설명)변수 사이의 관계를 분석
- 다중예측분석: 하나의 종속(반응)변수와 여러 독립(설명)변수 사이의 관계를 분석
- 선형회귀와 비선형회귀가 존재함

회귀모형관련 R코드
``` R
lm(formula, data, na.action) #함수 lm은 선형모형을 적합하기 위해 사용
#formula : 적합할 모형의 공식으로 ‘목표변수〜 입력변수의 선형결합’ 형식으로 구성. 
#data : 사용할 데이터 프레임의 이름을 지정
#na.action: 결측치 처리 옵션. na.fail은 결측치가 있으면 오류 메시지 발생, 

step(object, direction=c(“both”, “backward”, "forward"))
# 함수 step은 AIC를 이용한 모형선택을 위해 사용
# object : 함수 lm, glm 등에서 생성한 object를 입력
# direction : 변수선택 방법(“both”= 단계적 변수선택, “backward” =후진소거법, “forward”=전진선택법)을 지정함

predict(object, newdata, type)
# 함수 predict는 다양한 모형적합 결과로부터 예측값을 계산할 때 사용
# object : 함수 lm, glm 등에서 생성한 object를 입력
# newdata: 예측할 변수들로 구성된 데이터 프레임을 입력
# type : 예측형태를 입력하는 것으로, 목표값을 예측할 때 type = “response” 를 사용
```

```R
reg <- read.csv("r_reg.csv",fileEncoding = "EUC-KR")
str(reg)

library(dplyr)
mr <- reg %>% dplyr::select(신뢰관계,기업문화,스트레스,인재우대,기업혁신,조직몰입)
summary(mr)

mr.fit.all <- lm(조직몰입 ~ 신뢰관계+기업문화+스트레스+인재우대+기업혁신,data=mr)
summary(mr.fit.all)

par(mfrow=c(2,2))
plot(mr.fit.all,main = "multi linear regression")

par(mfrow=c(1,1))
hist(rstandard(mr.fit.all))
shapiro.test(rstandard(mr.fit.all))
#독립성 검정

#다중공선성 검정

mr.fit.step <- step(mr.fit.all,direction = "both")
# aic 가 작을수록 좋은 모형
summary(mr.fit.step)

pred.mr = predict(mr.fit.step,newdata = reg,type = "response")
#mse
mean((mr$조직몰입-pred.mr)^2)
#mae
mean(abs(mr$조직몰입-pred.mr))

#로지스틱 회귀 분석
data(iris)
a <- subset(iris,Species == "setosa" |Species == "versicolor")
a$Species <- factor(a$Species)
str(a)

b <- glm(Species~Sepal.Length,data=a,family=binomial)
summary(b)

pred.iris <- predict(b,newdata = a,type = "response")
pred.iris
yhat.iris <- ifelse(pred.iris > 0.5,"versicolor","setosa")
yhat.iris
table_iris <- table(a$Species,yhat.iris)
table_iris

#install.packages("e1071")
#confusionMatrix 는 행은 예측값 열은 실제 값이 들어가야함
library(caret)
confusionMatrix(t(table_iris)) #입력값 전치되어 있지 않으면 전치해야함
```